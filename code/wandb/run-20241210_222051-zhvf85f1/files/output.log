INFO:__main__:Loading model from ./results/final_model
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 12.22it/s]
INFO:__main__:Loading test data from ../../inference_results.jsonl
INFO:__main__:Number of test samples: 1
Inference:   0%|                                                                                               | 0/1 [00:08<?, ?it/s]
['You are a math teacher.\nAt the end of the Solution verification, when you give your final grade, write it in the form "Verification: Is the answer correct (Yes/No)? X", where X is either Yes or No.\n\nQuestion: Carol spends 4 hours writing a song, half that much time recording it, and 90 minutes editing it. What percentage of her total work time did she spend editing?\nSolution: Half of 4 hours is 2 hours. So the time spent recording is 2 hours. Add the editing time of 90 minutes and the total time for the entire project is 4 + 2 + 1.5 = 7.5 hours. That means she spent (90 / 7.5) * 100 = 12% of the total time editing. The answer is 12.\n', 'You are a math teacher.\nAt the end of the Solution verification, when you give your final grade, write it in the form "Verification: Is the answer correct (Yes/No)? X", where X is either Yes or No.\n\nQuestion: Carol spends 4 hours writing a song, half that much time recording it, and 90 minutes editing it. What percentage of her total work time did she spend editing?\nSolution: Half of 4 hours is 2 hours. So the time spent recording is 2 hours. Add the editing time of 90 minutes and the total time for the entire project is 4 + 2 + 1.5 = 7.5 hours. That means she spent (90 / 7.5) * 100 = 12% of the total time editing. The answer is 12.\n\n\nVerification: Is the answer correct (Yes/No)?', 'You are a math teacher.\nAt the end of the Solution verification, when you give your final grade, write it in the form "Verification: Is the answer correct (Yes/No)? X", where X is either Yes or No.\n\nQuestion: Carol spends 4 hours writing a song, half that much time recording it, and 90 minutes editing it. What percentage of her total work time did she spend editing?\nSolution: Half of 4 hours is 2 hours. So the time spent recording is 2 hours. Add the editing time of 90 minutes and the total time for the entire project is 4 + 2 + 1.5 = 7.5 hours. That means she spent (90 / 7.5) * 100 = 12% of the total time editing. The answer is 12.\n\nVerification: Is the answer correct (Yes/No)? Yes\nX = Yes', 'You are a math teacher.\nAt the end of the Solution verification, when you give your final grade, write it in the form "Verification: Is the answer correct (Yes/No)? X", where X is either Yes or No.\n\nQuestion: Carol spends 4 hours writing a song, half that much time recording it, and 90 minutes editing it. What percentage of her total work time did she spend editing?\nSolution: Half of 4 hours is 2 hours. So the time spent recording is 2 hours. Add the editing time of 90 minutes and the total time for the entire project is 4 + 2 + 1.5 = 7.5 hours. That means she spent (90 / 7.5) * 100 = 12% of the total time editing. The answer is 12.\n', 'You are a math teacher.\nAt the end of the Solution verification, when you give your final grade, write it in the form "Verification: Is the answer correct (Yes/No)? X", where X is either Yes or No.\n\nQuestion: Carol spends 4 hours writing a song, half that much time recording it, and 90 minutes editing it. What percentage of her total work time did she spend editing?\nSolution: Half of 4 hours is 2 hours. So the time spent recording is 2 hours. Add the editing time of 90 minutes and the total time for the entire project is 4 + 2 + 1.5 = 7.5 hours. That means she spent (90 / 7.5) * 100 = 12% of the total time editing. The answer is 12.\n', 'You are a math teacher.\nAt the end of the Solution verification, when you give your final grade, write it in the form "Verification: Is the answer correct (Yes/No)? X", where X is either Yes or No.\n\nQuestion: Carol spends 4 hours writing a song, half that much time recording it, and 90 minutes editing it. What percentage of her total work time did she spend editing?\nSolution: Half of 4 hours is 2 hours. So the time spent recording is 2 hours. Add the editing time of 90 minutes and the total time for the entire project is 4 + 2 + 1.5 = 7.5 hours. That means she spent (90 / 7.5) * 100 = 12% of the total time editing. The answer is 12.\n\nVerification: Is the answer correct? Yes\n6', 'You are a math teacher.\nAt the end of t
Generated Text: You are a math teacher.
At the end of the Solution verification, when you give your final grade, write it in the form "Verification: Is the answer correct (Yes/No)? X", where X is either Yes or No.

Question: Carol spends 4 hours writing a song, half that much time recording it, and 90 minutes editing it. What percentage of her total work time did she spend editing?
Solution: Half of 4 hours is 2 hours. So the time spent recording is 2 hours. Add the editing time of 90 minutes and the total time for the entire project is 4 + 2 + 1.5 = 7.5 hours. That means she spent (90 / 7.5) * 100 = 12% of the total time editing. The answer is 12.
Traceback (most recent call last):
  File "/home/llm4math/LLM-for-Math/Direct Verifier/code/infer.py", line 116, in <module>
    main(args)
  File "/home/llm4math/LLM-for-Math/Direct Verifier/code/infer.py", line 86, in main
    average_score, generated_texts = perform_inference(
                                     ^^^^^^^^^^^^^^^^^^
  File "/home/llm4math/LLM-for-Math/Direct Verifier/code/infer.py", line 45, in perform_inference
    grade = compute_yes_no_probability(text, tokenizer, model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/llm4math/LLM-for-Math/Direct Verifier/code/inference/utils.py", line 43, in compute_yes_no_probability
    raise ValueError("Cannot find a final 'Yes' or 'No' after 'Verification: Is the answer correct (Yes/No)?'")
ValueError: Cannot find a final 'Yes' or 'No' after 'Verification: Is the answer correct (Yes/No)?'
